<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Manajemen Pengguna - Fajar Microbank</title>

  <!-- Fonts & Icons -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet"/>

  <style>
    :root{
      --accent:#2ecc71;
      --warn:#f39c12;
      --danger:#e74c3c;
      --bg:#fafafa;
      --card:#ffffff;
      --text:#333;
      --sub:#777;
      --border:#e0e0e0;
      --blue:#3498db;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:'Roboto',sans-serif;background:var(--bg);color:var(--text)}

    header{
      background:#fff;border-bottom:4px solid var(--accent);
      padding:14px 18px;display:flex;align-items:center;gap:8px;
    }
    header .material-icons{color:var(--accent);cursor:pointer}
    header h1{margin:0;font-size:1.1rem;}

    main{max-width:960px;margin:22px auto;padding:0 16px 100px;}

    .search-row{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;flex-wrap:wrap;gap:8px;}
    .search-row input{
      flex:1;min-width:240px;padding:10px;border:1px solid #ccc;border-radius:8px;font-size:1rem;
    }
    .btn{
      border:none;border-radius:10px;padding:10px 14px;cursor:pointer;font-weight:600;
      display:inline-flex;align-items:center;gap:8px;
      background:var(--accent);color:#fff;
    }
    .btn.secondary{background:#e0e0e0;color:#222}
    .btn.danger{background:var(--danger)}

    .user-list{display:grid;gap:10px;}
    .card{
      background:var(--card);border:1px solid var(--border);border-radius:16px;
      padding:12px 16px;display:flex;align-items:center;gap:12px;
      box-shadow:0 4px 10px rgba(0,0,0,.04);
    }
    .avatar{
      width:56px;height:56px;border-radius:50%;background:#eee;display:flex;justify-content:center;align-items:center;
      font-weight:700;color:#666;font-size:1.1rem;border:1px solid var(--border);
    }
    .user-info{flex:1;}
    .user-info .name{font-weight:700;font-size:1.05rem;margin:0;}
    .user-info .email{color:var(--sub);font-size:.92rem;margin-top:2px;}
    .role-pill{
      display:inline-block;padding:4px 10px;border-radius:999px;font-size:.85rem;font-weight:600;margin-top:4px;
      color:#fff;
    }
    .role-superadmin{background:var(--accent);}
    .role-supervisor{background:var(--warn);}
    .role-staff{background:var(--blue);}
    .actions{display:flex;gap:6px;}
    .actions button{font-size:.85rem;padding:6px 10px;border-radius:8px;}

    .empty{background:#fff;border:1px solid var(--border);border-radius:14px;padding:18px;text-align:center;color:#777;}

    /* Toast */
    .toast{
      position:fixed;left:50%;bottom:76px;transform:translateX(-50%);
      background:#323232;color:#fff;border-radius:999px;padding:10px 14px;font-size:.95rem;
      opacity:0;pointer-events:none;transition:opacity .2s ease;
    }
    .toast.show{opacity:1}

    /* Modal */
    .overlay{position:fixed;inset:0;background:rgba(0,0,0,.45);display:none;justify-content:center;align-items:center;padding:16px;z-index:20;}
    .dialog{background:#fff;width:100%;max-width:420px;border-radius:14px;padding:16px;box-shadow:0 10px 30px rgba(0,0,0,.25)}
    .dialog h3{margin:0 0 8px 0}
    .dialog p{margin:6px 0;color:#555}
    .dialog .actions{display:flex;justify-content:flex-end;gap:8px;margin-top:10px}
    label{display:block;margin:10px 0 4px;font-weight:600}
    input[type="text"],input[type="email"],select{
      width:100%;padding:10px;border:1px solid #ccc;border-radius:8px;font-size:1rem;
    }
  </style>
</head>
<body>
  <header>
    <span class="material-icons" onclick="goHome()">arrow_back</span>
    <h1>Manajemen Pengguna</h1>
  </header>

  <main>
    <div class="search-row">
      <input id="searchBox" type="text" placeholder="Cari nama atau email..."/>
      <button class="btn" onclick="openUserModal()"><span class="material-icons">person_add</span>Tambah Pengguna</button>
    </div>

    <div id="userList" class="user-list"></div>
    <div id="emptyMsg" class="empty" style="display:none;">Tidak ada pengguna ditemukan.</div>
  </main>

  <!-- Toast -->
  <div id="toast" class="toast">Tersimpan</div>

  <!-- Add/Edit Modal -->
  <div id="userModal" class="overlay">
    <div class="dialog">
      <h3 id="modalTitle">Tambah Pengguna</h3>
      <label>Nama Lengkap</label>
      <input id="uName" type="text" placeholder="Nama pengguna"/>
      <label>Email Login</label>
      <input id="uEmail" type="email" placeholder="email@domain.com"/>
      <label>Peran</label>
      <select id="uRole">
        <option value="">Pilih peran...</option>
        <option value="Superadmin">Superadmin</option>
        <option value="Supervisor">Supervisor</option>
        <option value="Staff">Staff</option>
      </select>
      <div class="actions">
        <button class="btn secondary" onclick="closeUserModal()">Batal</button>
        <button class="btn" onclick="saveUser()">Simpan</button>
      </div>
    </div>
  </div>

  <!-- Confirm Modal -->
  <div id="confirmModal" class="overlay">
    <div class="dialog">
      <h3>Konfirmasi</h3>
      <p id="confirmText">Anda yakin ingin menonaktifkan pengguna ini?</p>
      <div class="actions">
        <button class="btn secondary" onclick="closeConfirm()">Batal</button>
        <button class="btn danger" onclick="confirmDeactivate()">Ya</button>
      </div>
    </div>
  </div>

  <script>
    const users = [
      {id:1,name:"Alfred Stephen",email:"alfred@fajarmicrobank.id",role:"Superadmin",active:true},
      {id:2,name:"Siti Rahmawati",email:"siti@fajarmicrobank.id",role:"Supervisor",active:true},
      {id:3,name:"Budi Santoso",email:"budi@fajarmicrobank.id",role:"Staff",active:true},
      {id:4,name:"Wawan Setiawan",email:"wawan@fajarmicrobank.id",role:"Staff",active:false},
    ];

    let editingId = null;
    let pendingId = null;

    const listEl = document.getElementById("userList");
    const emptyEl = document.getElementById("emptyMsg");
    const searchBox = document.getElementById("searchBox");
    const toast = document.getElementById("toast");

    function goHome(){ window.location.href="home.html"; }

    // ---------- Render ----------
    function renderUsers(){
      listEl.innerHTML="";
      const q = searchBox.value.toLowerCase();
      const filtered = users.filter(u=>u.name.toLowerCase().includes(q)||u.email.toLowerCase().includes(q));
      if(filtered.length===0){ emptyEl.style.display="block"; return; }
      emptyEl.style.display="none";
      filtered.forEach(u=>{
        const card=document.createElement("div");
        card.className="card";
        const avatar=document.createElement("div");
        avatar.className="avatar";
        avatar.textContent=u.name.split(" ").map(x=>x[0]).join("").substring(0,2).toUpperCase();
        card.appendChild(avatar);

        const info=document.createElement("div");
        info.className="user-info";
        const nm=document.createElement("div");nm.className="name";nm.textContent=u.name;
        const em=document.createElement("div");em.className="email";em.textContent=u.email;
        const role=document.createElement("div");
        role.className=`role-pill role-${u.role.toLowerCase()}`;
        role.textContent=u.role+(u.active?"":" (nonaktif)");
        info.appendChild(nm);info.appendChild(em);info.appendChild(role);
        card.appendChild(info);

        const act=document.createElement("div");
        act.className="actions";
        const btnEdit=document.createElement("button");
        btnEdit.className="btn secondary";
        btnEdit.innerHTML='<span class="material-icons" style="font-size:16px;">edit</span>Edit';
        btnEdit.onclick=()=>editUser(u.id);
        const btnToggle=document.createElement("button");
        btnToggle.className="btn "+(u.active?"danger":"");
        btnToggle.innerHTML='<span class="material-icons" style="font-size:16px;">'+(u.active?"block":"check_circle")+'</span>'+(u.active?"Nonaktifkan":"Aktifkan");
        btnToggle.onclick=()=>confirmToggle(u.id);
        act.appendChild(btnEdit);act.appendChild(btnToggle);
        card.appendChild(act);
        listEl.appendChild(card);
      });
    }

    // ---------- Search ----------
    searchBox.addEventListener("input",renderUsers);

    // ---------- Modal handling ----------
    function openUserModal(editId=null){
      editingId = editId;
      document.getElementById("userModal").style.display="flex";
      if(editId){
        const u=users.find(x=>x.id===editId);
        document.getElementById("modalTitle").textContent="Edit Pengguna";
        document.getElementById("uName").value=u.name;
        document.getElementById("uEmail").value=u.email;
        document.getElementById("uRole").value=u.role;
      }else{
        document.getElementById("modalTitle").textContent="Tambah Pengguna";
        document.getElementById("uName").value="";
        document.getElementById("uEmail").value="";
        document.getElementById("uRole").value="";
      }
    }
    function closeUserModal(){document.getElementById("userModal").style.display="none";}

    // ---------- Save user ----------
    function saveUser(){
      const name=document.getElementById("uName").value.trim();
      const email=document.getElementById("uEmail").value.trim();
      const role=document.getElementById("uRole").value;
      if(name.length<3){showToast("Nama minimal 3 huruf");return;}
      if(!email.includes("@")||!email.includes(".")){showToast("Email tidak valid");return;}
      if(!role){showToast("Pilih peran");return;}
      if(editingId){
        const u=users.find(x=>x.id===editingId);
        u.name=name;u.email=email;u.role=role;
        showToast("Data pengguna diperbarui");
      }else{
        const id=Math.max(...users.map(x=>x.id))+1;
        users.push({id,name,email,role,active:true});
        showToast("Pengguna baru ditambahkan");
      }
      closeUserModal();renderUsers();
    }

    // ---------- Edit ----------
    function editUser(id){openUserModal(id);}

    // ---------- Deactivate/Activate ----------
    function confirmToggle(id){
      pendingId=id;
      const u=users.find(x=>x.id===id);
      const txt=document.getElementById("confirmText");
      txt.textContent=u.active?"Anda yakin ingin menonaktifkan pengguna ini?":"Aktifkan kembali pengguna ini?";
      document.getElementById("confirmModal").style.display="flex";
    }
    function closeConfirm(){document.getElementById("confirmModal").style.display="none";}
    function confirmDeactivate(){
      const u=users.find(x=>x.id===pendingId);
      u.active=!u.active;
      closeConfirm();
      showToast(u.active?"Pengguna diaktifkan kembali":"Pengguna dinonaktifkan");
      renderUsers();
    }

    // ---------- Toast ----------
    function showToast(msg){
      toast.textContent=msg;
      toast.classList.add("show");
      setTimeout(()=>toast.classList.remove("show"),1800);
    }

    // ---------- Init ----------
    document.addEventListener("DOMContentLoaded",renderUsers);
  </script>
</body>
</html>